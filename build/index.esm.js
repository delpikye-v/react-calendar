import e,{useState as t,useRef as a,useEffect as n}from"react";import r from"joinclass";var o=function(){return o=Object.assign||function(e){for(var t,a=1,n=arguments.length;a<n;a++)for(var r in t=arguments[a])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e},o.apply(this,arguments)};function l(e,t,a){if(a||2===arguments.length)for(var n,r=0,o=t.length;r<o;r++)!n&&r in t||(n||(n=Array.prototype.slice.call(t,0,r)),n[r]=t[r]);return e.concat(n||Array.prototype.slice.call(t))}var c=function(e,t){return e.reduce((function(e,a,n){return(n%t==0?e.push([a]):e[e.length-1].push(a))&&e}),[])};function i(t){var a=t.value,n=t.display,o=t.isSelected,l=t.neighbor,c=t.setSelected;return e.createElement("span",{className:r("picker-cell month-year-cell",o&&"date-is-today",l&&"date-neighbor-target"),onClick:function(){return c(a)},onTouchCancel:function(){return c(a)}},n||a)}var u=function(t){var a=t.labelMonths,n=void 0===a?[]:a,r=t.selected,o=t.isSameYear,l=t.setSelected,u=void 0===l?function(){}:l,s=c(n,3);return e.createElement(e.Fragment,null,s.map((function(t,a){return e.createElement("div",{key:a,className:"date-row",role:"row"},t.map((function(t,n){var l=3*a+n;return e.createElement(i,{key:n,isSelected:l===r&&o,display:t,value:l,setSelected:u})})))})))},s=function(t){for(var a=t.decadeData,n=t.selected,r=t.setSelected,o=void 0===r?function(){}:r,l=a[0],u=a[1],s=[],d=l-1;d<=u+1;d++)s.push(d);var m=c(s,3);return e.createElement(e.Fragment,null,m.map((function(t,a){return e.createElement("div",{key:a,className:"date-row",role:"row"},t.map((function(t,a){return e.createElement(i,{key:a,neighbor:t<l||t>u,isSelected:t===n,value:t,setSelected:o})})))})))};function d(e,t){return t>11?(e++,t=0):t<0&&(e--,t=11),[e,t]}function m(e){return[31,e%4==0&&e%100!=0||e%400==0?29:28,31,30,31,30,31,31,30,31,30,31]}function h(e,t){var a=d(e,t),n=a[0],r=a[1];return{year:n,month:r,maxDayOfMonth:m(n)[r],otherMonth:!0}}function f(e,t,a){var n=e+"0".concat(t).slice(-2)+"0".concat(a).slice(-2);return Number(n)}function y(e){var t=Number("".concat(e.toString()[2],"0")),a=e.toString().substring(0,2);return[t=Number(0===t?"".concat(a,"00"):"".concat(a).concat(t)),t+9]}var v=["January","February","March","April","May","June","July","August","September","October","November","December"],g=[{name:"Sunday",shortName:"Sun"},{name:"Monday",shortName:"Mon"},{name:"Tuesday",shortName:"Tue"},{name:"Wednesday",shortName:"Wed"},{name:"Thursday",shortName:"Thu"},{name:"Friday",shortName:"Fri"},{name:"Saturday",shortName:"Sat"}],p=function(c){var i=c.className,p=c.todayClassName,E=c.selectedClassName,N=c.neighborMonthClassName,b=c.labelMonthYearClassName,k=c.weekClassName,D=c.width,M=void 0===D?"300px":D,S=c.height,w=void 0===S?"300px":S,F=c.readOnly,T=void 0!==F&&F,O=c.show,C=void 0===O||O,Y=c.showAnchor,x=void 0!==Y&&Y,A=c.labelNext,R=c.labelBack,L=c.weekStart,W=void 0===L?"sunday":L,j=c.fitMonthDay,J=c.notBeforeTime,V=c.notAfterTime,B=c.value,P=c.showToday,q=void 0===P||P,z=c.i18nLabelWeek,G=c.i18nLabelMonth,H=c.onSelectedValue,I=void 0===H?function(){}:H,K=c.onChangeView,Q=void 0===K?function(){}:K,U=c.onClickWeekLabel,X=void 0===U?function(){}:U,Z=c.formatTittleYearMonth,$=c.formartDayValue,_=t(B||new Date),ee=_[0],te=_[1],ae=a(null),ne=t([]),re=ne[0],oe=ne[1],le=t([]),ce=le[0],ie=le[1],ue=t([]),se=ue[0],de=ue[1],me=t("date"),he=me[0],fe=me[1],ye=t([]),ve=ye[0],ge=ye[1],pe=Array.isArray(z)&&7===z.length;n((function(){var e=B||new Date;te(B||new Date),ke(e.getFullYear(),e.getMonth(),e)}),[B,M,w,q,J,V,G,T,j]),n((function(){var e=pe?z:g;oe("monday"!==W?l([],e,!0):l(l([],e.slice(1),!0),[e[0]],!1))}),[W,z]),n((function(){!C&&fe("date")}),[C]);var Ee,Ne,be=function(e,t,a,n,r){if(!n&&!r)return!1;var o=f(e,t,a);return r>0&&n>0?!(n<=o&&o<=r):r>0&&o>r||n>0&&o<n},ke=function(e,t,a){var n=new Date,r=n.getDate(),c=n.getMonth(),i=n.getFullYear(),u=new Date(e,t,1).getDay(),s=m(e)[t],d=h(e,t-1),y=h(e,t+1),v=function(e,t){return t===a.getDate()&&e.month===a.getMonth()&&e.year===a.getFullYear()},g=J?f(J.getFullYear(),J.getMonth(),J.getDate()):0,p=V?f(V.getFullYear(),V.getMonth(),V.getDate()):0;"monday"===W&&(0===u?u=6:u-=1);var E=[],N=[],b=1;if(0!==u||0===u&&28===s)for(var k=d.maxDayOfMonth-u+1;k<=d.maxDayOfMonth;k++)N.push(o(o({},d),{dayDisplay:k,isSelected:v(d,k),isOverRange:be(d.year,d.month,k,g,p),fitMonthDay:j}));var D=N.length;b=N.length,7===N.length&&(E.push(l([],N,!0)),N=[],b=1);for(k=1;k<=s;k++)N.push({year:e,month:t,maxDayOfMonth:s,dayDisplay:k,isToday:r===k&&c===t&&i===e,isSelected:v({year:e,month:t},k),isOverRange:be(e,t,k,g,p)}),++b>=7&&(E.push(l([],N,!0)),N=[],b=0);var M=42-D-s;for(k=1;k<=M;k++)N.push(o(o({},y),{dayDisplay:k,isSelected:v(y,k),isOverRange:be(y.year,y.month,k,g,p),fitMonthDay:j})),++b>=7&&(E.push(l([],N,!0)),N=[],b=0);N.length>0&&E.push(l([],N,!0)),ie(E),ge([e,t])},De=function(){ae.current.classList.add("fade"),setTimeout((function(){return ae.current.classList.remove("fade")}),50)},Me=function(e){if(!T){var t=new Date(e.year,e.month,e.dayDisplay,0,0,0);te(t),I(t),ke(e.year,e.month,t)}},Se=function(){return"month"===he?(de(y(ve[0])),fe("year"),De(),void Q(he)):"date"===he?(fe("month"),De(),void Q(he)):void 0},we=function(e){De();var t=ve[0],a=ve[1];if("date"!==he){if("year"===he){var n=t+10*e;return de(y(n)),void ge([n,a])}var r=d(t+e,a),o=r[0],l=r[1];ke(o,l,ee)}else{var c=d(t,a+e),i=c[0],u=c[1];ke(i,u,ee)}};return C?e.createElement("div",{style:{width:M,height:j?"auto":w},className:r("date-picker2",i)},e.createElement("div",{className:"date-picker2-header"},e.createElement("span",{className:"date-picker2-nav-button button-left",onClick:function(){return we(-1)},onTouchEnd:function(){return we(-1)}},R?e.createElement(e.Fragment,null,R):e.createElement(e.Fragment,null," 〈")),x&&e.createElement("span",{className:"date-picker2-anchor left-label"}),e.createElement("span",{ref:ae,className:r("date-picker2-title-month-year",b),onClick:Se,onTouchEnd:Se},(Ee=ve[0],Ne=ve[1],Z?"month"===he?Z(Ee,-1):"year"===he?Z(-1,-1,se):Z(Ee,Ne+1):"month"===he?Ee||"":"year"===he?"".concat(se[0]," - ").concat(se[1]):"".concat((G||v)[Ne]||""," ").concat(Ee||"").trim())),x&&e.createElement("span",{className:"date-picker2-anchor right-label"}),e.createElement("span",{className:"date-picker2-nav-button button-right",onClick:function(){return we(1)},onTouchEnd:function(){return we(1)}},A?e.createElement(e.Fragment,null,A):e.createElement(e.Fragment,null,"〉"))),e.createElement("div",{className:"date-picker2-calendar",role:"grid"},"date"===he?e.createElement((function(){return e.createElement(e.Fragment,null,e.createElement("div",{className:"date-row",role:"row"},re.map((function(t,a){return e.createElement("span",{key:a,className:r("week-label date-cell",k),"aria-readonly":"true",onClick:function(){return X(t)},onTouchEnd:function(){return X(t)}},t.shortName)}))),ce.map((function(t,a){return e.createElement("div",{key:a,className:"date-row",role:"row"},t.map((function(t,a){var n=t.fitMonthDay||T;return e.createElement("span",{key:a,className:r("picker-cell date-cell",t.otherMonth&&"date-neighbor-target",t.otherMonth&&N,t.isToday&&q&&"date-is-today",t.isToday&&p,!n&&t.isSelected&&"date-is-selected",!n&&t.isSelected&&E,n&&"read-only",!n&&t.isOverRange&&"disabled-over-range-time"),onClick:function(){return!n&&!t.isOverRange&&Me(t)},onTouchEnd:function(){return!n&&!t.isOverRange&&Me(t)}},t.fitMonthDay?e.createElement(e.Fragment,null):$?$(t.dayDisplay):t.dayDisplay)})))})))}),null):"month"===he?e.createElement(u,{labelMonths:G||v,selected:ee.getMonth(),isSameYear:ee.getFullYear()===ve[0],setSelected:function(e){var t=d(ve[0],e),a=t[0],n=t[1];ke(a,n,ee),fe("date"),Q("date")}}):e.createElement(s,{decadeData:se,selected:ee.getFullYear(),setSelected:function(e){ge([e,ve[1]]),fe("month"),Q("month")}}))):e.createElement(e.Fragment,null)};export{p as DateTimePicker,p as default};
